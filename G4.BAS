DECLARE SUB KeyBufferEmpty ()
DECLARE SUB Cls2 (n)
DECLARE SUB PUTSCORES ()
DECLARE SUB DRAWSCORELINES ()
DECLARE SUB DRAWBORDER ()
DECLARE SUB DRAWLEVEL ()
DECLARE SUB READINSTR ()
DECLARE SUB SPARKLE ()
DECLARE SUB INTRO ()
CLS
'**************************VARIABLES*****************************
DIM SHARED I$(4)
DIM CURSTEPS(10)
RANDOMIZE TIMER
GO$ = "******************************************************************************"
RSG2:
LCOUNT = 0
M = 1
STEPS = 0
MSGCOUNT = 0
 LIVES = 5
 X = 27:  Y = 79
 MX = 4:  MY = 79
 PX = 0:  PY = 0
 SX = 0:  SY = 0
 L = 1
 TOTSTEPS = 0
 SCORE = 0
LES = 0
WAND.DIR = 0
WAND.SHOOT = 0
WANDS = 0
DIFFICULTY = 0
 LX = 6
 LEX = 0:  LEY = 0
 OOS = 0:  OOS2 = 0: OOS3 = 0
 MSG = 0:  SFX = 1
 LASER = 0
ED:
LOCATE 1, 1
INPUT "Enter Difficulty (1-10)"; DIFFICULTY
IF DIFFICULTY > 10 THEN GOTO ED
CLS
INTRO
READINSTR
LE$ = "LEVEL:"
G$ = "THANKS FOR PLAYING!"
'**************GET SCREEN READY FOR GAME***************
RSG:
 IF L = 11 THEN GOTO FinishedGame
 FS = 1
 IF LIVES < 0 THEN GOTO GameOver
 LASER = 0
 M = 1
 X = 27:  Y = 79
 MX = 4:  MY = 79
 MSG = 0
 OOS = 0:  OOS2 = 0
 PX = 0:  PY = 0
 SX = 0:  SY = 0
 LX = 6
CLS
FOR A = 1 TO 6
FOR Z = 1 TO 10
COLOR 9
LOCATE Z, A + 9: PRINT MID$(LE$, A, 1)
FOR P = 1 TO 200: NEXT
COLOR 0
LOCATE Z, A + 9: PRINT MID$(LE$, A, 1)
NEXT
COLOR 9
LOCATE 10, A + 9: PRINT MID$(LE$, A, 1)
NEXT
LOCATE 10, 17: PRINT L
IF L >= 5 THEN COLOR 4: LOCATE 11, 10: PRINT "WATCH OUT FOR THE LASER CANNON!"
FOR P = 1 TO 3000: NEXT


CLS
SCREEN 12
WIDTH 80, 60
DRAWLEVEL
DRAWBORDER
DRAWSCORELINES

'******************THE MAIN LOOP***************
IF L >= 5 THEN LASER = 1
LOCATE 2, 2: COLOR 2: PRINT "SCORE:": LOCATE 2, 8: PRINT SCORE
LOCATE 2, 13: PRINT "STEPS:": LOCATE 2, 19: PRINT STEPS
LOCATE 2, 24: PRINT "LEVEL:": LOCATE 2, 30: PRINT L
LOCATE 2, 33: PRINT "LIVES:": LOCATE 2, 39: PRINT LIVES
ML:
IF STEPS >= 1000 THEN GOTO Over1000
IF LASER = 1 AND LES = 1 AND M = 1 AND MX = LEX AND MY = LEY THEN GOTO MonShot
IF LASER = 1 AND M = 1 AND MX = LX AND MY = 2 THEN GOTO MonShot
IF LASER = 1 AND X = LX AND Y = 2 THEN GOTO GotShot
IF LASER = 1 AND FS = 1 THEN GOTO MoveLaser
IF LES = 1 AND LASER = 1 THEN LCOUNT = LCOUNT + 1
IF LASER = 1 AND LES = 1 AND LCOUNT >= 2 THEN GOTO UpdateLaser
IF LASER = 1 AND LES = 1 AND LEX = X AND LEY = Y THEN GOTO GotShot
IF MSG = 1 THEN MSGCOUNT = MSGCOUNT + 1
IF MSGCOUNT >= 20 THEN GOTO TakeMessageOffScreen
IF OOS = 1 THEN LOCATE PX, PY: COLOR 2: PRINT "þ"
IF OOS2 = 1 THEN LOCATE SX, SY: COLOR 4: PRINT "þ"
IF OOS3 = 1 THEN LOCATE WX, WY: COLOR 5: PRINT "/"
IF OOS = 1 AND X = PX AND Y = PY THEN GOTO GotObj
IF OOS2 = 1 AND X = SX AND Y = SY THEN GOTO GotObj2
IF OOS3 = 1 AND X = WX AND Y = WY THEN GOTO GotObj3
IF MX = X AND MY = Y THEN GOTO GotEaten
POOS1 = INT(RND * 150): IF POOS1 = 25 AND OOS = 0 THEN GOTO PutObject
POOS2 = INT(RND * 150): IF POOS2 = 25 AND OOS2 = 0 THEN GOTO PutObject2
POOS3 = INT(RND * 150): IF POOS3 = 10 AND OOS3 = 0 THEN GOTO PutObject3

IF X = 4 AND Y = 2 THEN GOTO FinishedLevel
A$ = INKEY$
        IF A$ = CHR$(0) + "H" THEN GOTO Up
        IF A$ = CHR$(0) + "P" THEN GOTO Down
        IF A$ = CHR$(0) + "K" THEN GOTO Left
        IF A$ = CHR$(0) + "M" THEN GOTO Right
        IF A$ = "S" THEN GOTO SoundChange
        IF A$ = "P" THEN GOTO Pausegame
        IF A$ = "Q" THEN GOTO Quitgame
        IF A$ = "J" THEN GOTO Jump
        IF A$ = "-" THEN GOTO FinishedLevel
        IF A$ = "=" THEN STEPS = STEPS - 10: IF STEPS < 0 THEN STEPS = 0: LOCATE 2, 13: PRINT "STEPS:": LOCATE 2, 19: COLOR 2: PRINT STEPS
        IF A$ = "/" THEN WANDS = 99
        IF A$ = "R" THEN GOTO W.Up
        IF A$ = "F" THEN GOTO W.Down
        IF A$ = "D" THEN GOTO W.Left
        IF A$ = "G" THEN GOTO W.Right
        IF WANDS.SHOOT = 1 THEN GOTO WandUpdate
IF M = 1 THEN GOTO MM
GOTO ML
'*************MOVING**********************************************
Up:
IF X - 1 = 3 THEN GOTO HitSide
IF SCREEN(X - 1, Y) = 196 THEN GOTO HitWall
X = X - 1
LOCATE X, Y: COLOR 14: PRINT "X"
LOCATE X + 1, Y: PRINT " "
STEPS = STEPS + 1
IF SFX = 1 THEN SOUND 200, .1
COLOR 2
LOCATE 2, 13: PRINT "STEPS:": LOCATE 2, 19: PRINT STEPS
GOTO ML

Down:
IF X + 1 = 28 THEN GOTO HitSide
IF SCREEN(X + 1, Y) = 196 THEN GOTO HitWall
X = X + 1
LOCATE X, Y: COLOR 14: PRINT "X"
LOCATE X - 1, Y: PRINT " "
STEPS = STEPS + 1
IF SFX = 1 THEN SOUND 200, .1
COLOR 2
LOCATE 2, 13: PRINT "STEPS:": LOCATE 2, 19: PRINT STEPS
GOTO ML

Left:
IF Y - 1 = 1 THEN GOTO HitSide
IF SCREEN(X, Y - 1) = 196 THEN GOTO HitWall
Y = Y - 1
LOCATE X, Y: COLOR 14: PRINT "X"
LOCATE X, Y + 1: PRINT " "
STEPS = STEPS + 1
IF SFX = 1 THEN SOUND 200, .1
COLOR 2
LOCATE 2, 13: PRINT "STEPS:": LOCATE 2, 19: PRINT STEPS
GOTO ML

Right:
IF Y + 1 = 80 THEN GOTO HitSide
IF SCREEN(X, Y + 1) = 196 THEN GOTO HitWall
Y = Y + 1
LOCATE X, Y: COLOR 14: PRINT "X"
LOCATE X, Y - 1: PRINT " "
STEPS = STEPS + 1
IF SFX = 1 THEN SOUND 200, .1
COLOR 2
LOCATE 2, 13: PRINT "STEPS:": LOCATE 2, 19: PRINT STEPS
GOTO ML

Jump:
LOCATE 2, 42: COLOR 3: PRINT "$6,000,000 JUMP!!!!"
J2:
LOCATE X, Y: PRINT " "
IF SFX = 1 THEN FOR Z = 300 TO 600 STEP 5: SOUND Z, .1: NEXT
Y = INT(RND * 80)
X = INT(RND * 23)
IF X < 4 THEN GOTO HitSide
IF X > 27 THEN GOTO HitSide
IF Y < 2 THEN GOTO HitSide
IF Y = 80 THEN GOTO HitSide
IF SCREEN(X, Y) = 196 THEN GOTO HitWall
STEPS = STEPS + 1
COLOR 2
LOCATE 2, 13: PRINT "STEPS:": LOCATE 2, 19: PRINT STEPS
LOCATE X, Y: COLOR 14: PRINT "X": LOCATE 2, 42: PRINT "                   ": GOTO ML

'*********************putting objects************************************
PutObject:
OOS = 1
PX = INT(RND * 28)
PY = INT(RND * 80)
IF PX < 4 OR PX > 27 THEN GOTO PutObject
IF PY < 2 OR PY = 80 THEN GOTO PutObject
IF SCREEN(PX, PY) = 254 THEN GOTO PutObject
IF SCREEN(PX, PY) = 196 THEN GOTO PutObject
IF SFX = 1 THEN SOUND 800, .1
LOCATE PX, PY: COLOR 2: PRINT "þ"
GOTO ML

PutObject2:
OOS2 = 1
SX = INT(RND * 28)
SY = INT(RND * 80)
IF SX < 4 OR SX > 27 THEN GOTO PutObject2
IF SY < 2 OR SY = 80 THEN GOTO PutObject2
IF SCREEN(SX, SY) = 254 THEN GOTO PutObject2
IF SCREEN(SX, SY) = 196 THEN GOTO PutObject2
IF SFX = 1 THEN SOUND 800, .1
LOCATE SX, SY: COLOR 4: PRINT "þ"
GOTO ML

PutObject3:
OOS3 = 1
WX = INT(RND * 28)
WY = INT(RND * 80)
IF WX < 4 OR WX > 27 THEN GOTO PutObject3
IF WY < 2 OR WY = 80 THEN GOTO PutObject3
IF SCREEN(WX, WY) = 254 THEN GOTO PutObject3
IF SCREEN(WX, WY) = 196 THEN GOTO PutObject3
IF SFX = 1 THEN PLAY "L64O3CDEFG"
LOCATE WX, WY: COLOR 5: PRINT "/"
GOTO ML

'************Take messages off screen*****************
TakeMessageOffScreen:
LOCATE 2, 42: PRINT "                               "
MSG = 0: MSGCOUNT = 0
GOTO ML

'***********************UPDATE LASER**************
UpdateLaser:
IF LEY + 1 = 80 THEN LES = 0: LOCATE LEX, LEY: PRINT " ": GOTO MoveLaser
IF SCREEN(LEX, LEY + 1) = 196 THEN LES = 0: LOCATE LEX, LEY: PRINT " ": GOTO MoveLaser
LEY = LEY + 1: LOCATE LEX, LEY: COLOR 4: PRINT "-": LOCATE LEX, LEY - 1: PRINT " "
LCOUNT = 0
GOTO ML
'************************MOVE LASER***********************
MoveLaser:
IF SCREEN(LX + 1, 2) = 196 THEN LX = LX + 2: LES = 0: LOCATE LX - 2, 2: PRINT " ": LOCATE LX, 2: COLOR 4: PRINT "=": GOTO SL
IF LX + 1 = 28 OR LX + 2 = 28 THEN LX = 6: LOCATE 26, 2: PRINT " ": LOCATE LX, 2: COLOR 4: PRINT "="
LX = LX + 1: LOCATE LX - 1, 2: PRINT " ": LOCATE LX, 2: COLOR 4: PRINT "=": GOTO SL
'**********************SHOOT LASER***********************
SL:
FS = 0
LES = 1
LEX = LX
LEY = 3
IF SCREEN(LEX, LEY) = 196 THEN GOTO MoveLaser
LCOUNT = 0
IF SFX = 1 THEN PLAY "MB O4 L32 EDC"
GOTO ML

'**************************GOT OBJECTS***********************
GotObj:
IF SFX = 1 THEN SOUND 500, .1
IF MSG = 1 THEN MSGCOUNT = 0
MSG = 1
MSGCOUNT = 0
LOCATE 2, 42: COLOR 2: PRINT "-10 STEPS!                "
OOS = 0
STEPS = STEPS - 10
SCORE = SCORE + 10
COLOR 9
LOCATE 2, 2: COLOR 2: PRINT "SCORE:": LOCATE 2, 8: PRINT SCORE
LOCATE 2, 13: PRINT "STEPS:": LOCATE 2, 19: PRINT STEPS
GOTO ML

GotObj2:
IF SFX = 1 THEN SOUND 500, .1
IF MSG = 1 THEN MSGCOUNT = 0
MSG = 1
MSGCOUNT = 0
LOCATE 2, 42: COLOR 2: PRINT "50 POINTS!               "
OOS2 = 0
SCORE = SCORE + 50
LOCATE 2, 2: COLOR 2: PRINT "SCORE:": LOCATE 2, 8: PRINT SCORE
GOTO ML

GotObj3:
IF SFX = 1 THEN SOUND 500, .1
IF MSG = 1 THEN MSGCOUNT = 0
MSG = 1
MSGCOUNT = 0
LOCATE 2, 42: COLOR 2: PRINT "WAND!                    "
OOS3 = 0
SCORE = SCORE + 5
WANDS = WANDS + 1
LOCATE 2, 2: COLOR 2: PRINT "SCORE:": LOCATE 2, 8: PRINT SCORE
GOTO ML

GotEaten:
IF (INT(RND * 100) + 1) < (DIFFICULTY * 10) THEN GOTO GotEaten2 ELSE GOTO MM
GotEaten2:
IF SFX = 1 THEN FOR Z = 1000 TO 100 STEP -10: SOUND 100, .1: SOUND Z, .1: NEXT
KeyBufferEmpty
Cls2 0
LOCATE 10, 10: PRINT "YOU ARE EATEN. PRESS A KEY"
WHILE INKEY$ = "": WEND
Cls2 1
STEPS = 0
LIVES = LIVES - 1
GOTO RSG

'***********************HIT A WALL****************************
HitWall:
KeyBufferEmpty
IF SFX = 1 THEN FOR Z = 1000 TO 100 STEP -10: SOUND 100, .1: SOUND Z, .1: NEXT
Cls2 0
LOCATE 10, 10: COLOR 4: PRINT "YOU HIT A WALL. PRESS A KEY"
WHILE INKEY$ = "": WEND
Cls2 0
STEPS = 0
LIVES = LIVES - 1
GOTO RSG

HitSide:
KeyBufferEmpty
IF SFX = 1 THEN FOR Z = 1000 TO 100 STEP -10: SOUND 100, .1: SOUND Z, .1: NEXT
Cls2 0
LOCATE 10, 10: COLOR 4: PRINT "YOU HIT THE SIDE OF THE FEILD. PRESS A KEY"
WHILE INKEY$ = "": WEND
Cls2 0
STEPS = 0
LIVES = LIVES - 1
GOTO RSG

'********************OVER 1000 STEPS******************************
Over1000:
KeyBufferEmpty
IF SFX = 1 THEN FOR Z = 1000 TO 100 STEP -10: SOUND 100, .1: SOUND Z, .1: NEXT
FOR GO = 28 TO 1 STEP -1
        LOCATE GO: COLOR 4: PRINT GO$
NEXT
Cls2 1
FOR Z = 1 TO 2000: NEXT
LOCATE 10, 35: COLOR 4: PRINT "YOU USED OVER 1000 STEPS."
LOCATE 11, 35: COLOR 4: PRINT "PRESS A KEY"
WHILE INKEY$ = "": WEND
Cls2 1
STEPS = 0
LIVES = LIVES - 1
GOTO RSG

GotShot:
KeyBufferEmpty
IF SFX = 1 THEN FOR Z = 1000 TO 100 STEP -10: SOUND 100, .1: SOUND Z, .1: NEXT
Cls2 0
LOCATE 10, 10: COLOR 4: PRINT "YOU ARE HIT BY A LASER BEAM. PRESS A KEY"
WHILE INKEY$ = "": WEND
Cls2 1
STEPS = 0
LIVES = LIVES - 1
GOTO RSG


SoundChange:
IF SFX = 1 THEN SFX = 0: MSG = 1: MSGCOUNT = 0: LOCATE 2, 42: COLOR 5: PRINT "SOUND OFF": GOTO ML
IF SFX = 0 THEN SFX = 1: MSG = 1: MSGCOUNT = 0: PLAY "MBO2L16CF": LOCATE 2, 42: COLOR 5: PRINT "SOUND ON ": GOTO ML



Quitgame:
IF SFX = 1 THEN PLAY "MBL18EG"
LOCATE 2, 42: COLOR 5: PRINT "QUIT?!! ALLREADY?!!"
QL:
A$ = INKEY$
IF A$ = "Y" THEN GOTO GoodBye
IF A$ = "N" THEN LOCATE 2, 42: COLOR 0: PRINT "                     ": GOTO ML
GOTO QL

Pausegame:
SOUND 37, .1
COLOR 5: LOCATE 2, 42: PRINT "***PAUSED***"
WHILE INKEY$ = "": WEND
LOCATE 2, 42: PRINT "            "
SOUND 37, .1: GOTO ML

FinishedLevel:
IF SFX = 1 THEN PLAY "MB O2 MS L8 C L16 C L4 F"
Cls2 1
IF STEPS <= 10 THEN LOCATE 1, 1: COLOR 2: PRINT "YOU DID TERIFFIC!": GOTO MS
IF STEPS <= 25 THEN LOCATE 1, 1: COLOR 2: PRINT "YOU DID VERY WELL!": GOTO MS
IF STEPS <= 50 THEN LOCATE 1, 1: COLOR 2: PRINT "YOU DID PRETTY GOOD!": GOTO MS
IF STEPS <= 80 THEN LOCATE 1, 1: COLOR 2: PRINT "YOU DID SO-SO.": GOTO MS
IF STEPS <= 150 THEN LOCATE 1, 1: COLOR 2: PRINT "GET PRACTICE!": GOTO MS
IF STEPS <= 200 THEN LOCATE 1, 1: COLOR 2: PRINT "YOU DON'T HAVE MUCH LOVE FOR COMPUTER GAMES!": GOTO MS
IF STEPS >= 250 OR STEPS > 200 THEN LOCATE 2, 10: COLOR 2: PRINT "STOP PLAYING ME! YOUR SCORE IS TERRIBLE, STUPID!": GOTO MS
MS:
LOCATE 2, 1: COLOR 2: PRINT "You finished level"; L; "with"; STEPS; "steps!"
CURSTEPS(L) = STEPS
TOTSTEPS = TOTSTEPS + STEPS
FOR PS = 1 TO L
LOCATE 3 + PS, 10
IF L = PS THEN COLOR 4: PRINT "LEVEL:"; PS; " "; CURSTEPS(PS)
IF L <> PS THEN COLOR 2: PRINT "LEVEL:"; PS; " "; CURSTEPS(PS)
NEXT
LOCATE 14, 10: COLOR 5: PRINT "----------"
LOCATE 15, 10: PRINT "Total:"; TOTSTEPS
LOCATE 16, 10: PRINT "Average:"; TOTSTEPS / L
LOCATE 18, 30: PRINT "Press any key..."
WHILE INKEY$ = "": WEND
Cls2 1
L = L + 1
STEPS = 0
LIVES = LIVES + 1
GOTO RSG

GoodBye:
Cls2 1
FOR A = 1 TO LEN(G$)
FOR Z = 1 TO 10
COLOR 9
LOCATE Z, A + 9: PRINT MID$(G$, A, 1)
FOR P = 1 TO 200: NEXT
COLOR 0
LOCATE Z, A + 9: PRINT MID$(G$, A, 1)
NEXT
COLOR 9
LOCATE 10, A + 9: PRINT MID$(G$, A, 1)
NEXT
FOR P = 1 TO 3000: NEXT
Cls2 1
SCREEN 0, 0, 0
SYSTEM

GameOver:
FOR GO = 28 TO 1 STEP -1
        LOCATE GO: COLOR 4: PRINT GO$
NEXT

FOR Z = 1 TO 2000: NEXT
Cls2 1
LOCATE 10, 35: COLOR 4: PRINT "GAME OVER"
LOCATE 11, 30: COLOR 4: PRINT "PLAY AGAIN? TYPE Y OR N"
GOL:
A$ = INKEY$
IF A$ = "Y" THEN GOTO RSG2
IF A$ = "N" THEN GOTO GoodBye
GOTO GOL

MM:
MY = INT(RND * 80): IF MY < 2 OR MY > 79 THEN GOTO MM
MX = INT(RND * 23): IF MX < 4 OR MX > 27 THEN GOTO MM
IF MX = X AND MY = Y THEN GOTO GotEaten
GOTO ML

MonShot:
IF SFX = 1 THEN PLAY "MBO2 L8 C L4 F"
MSG = 1: MSGCOUNT = 0
LOCATE 2, 42: PRINT "Devil is dead!"
M = 0
MX = 0: MY = 0
GOTO ML

FinishedGame:
Cls2 1
IF TOTSTEPS <= 100 THEN LOCATE 1, 1: COLOR 2: PRINT "HEY?!!! REPROGRAMMING THIS GAME TO GET SUCH A GOOD SCORE ISN'T FAIR!!": GOTO RSF
IF TOTSTEPS <= 300 THEN LOCATE 1, 1: COLOR 2: PRINT "WOW!! YOU GOT A GREAT SCORE!!": GOTO RSF
IF TOTSTEPS <= 500 THEN LOCATE 1, 1: COLOR 2: PRINT "PRETTY GOOD FOR SUCH A STINKER... ER.. AH.. NEVER MIND.": GOTO RSF
IF TOTSTEPS <= 800 THEN LOCATE 1, 1: COLOR 2: PRINT "AN O.K. SCORE IF I DO SAY SO MYSELF!": GOTO RSF
IF TOTSTEPS <= 1000 THEN LOCATE 1, 1: COLOR 2: PRINT "YOU'VE GOT SUCH A GREAT SCORE! NOT! HA HA.": GOTO RSF
IF TOTSTEPS <= 1400 OR TOTSTEPS >= 1400 THEN LOCATE 1, 1: COLOR 2: PRINT "THE JERSY DEVIL SAW YOUR SCORE... HE'S (dying) OF LAUGHTER!": GOTO RSF
RSF:
LOCATE 10, 10: COLOR 3: PRINT "You finished the game with"; TOTSTEPS; "steps. Your"
LOCATE 11, 10: PRINT "score is"; SCORE; ".  You finished the game with"; LIVES; "lives."
LOCATE 12, 10: PRINT "Play again? Type Y or N"

FgLoop:
A$ = INKEY$
IF A$ = "Y" THEN Cls2 1: GOTO RSG2
IF A$ = "N" THEN GOTO GoodBye
GOTO FgLoop

W.Up:
IF WANDS = 0 THEN GOTO ML
IF WANDS.SHOOT = 1 THEN GOTO ML
IF X - 1 < 4 THEN WANDS.SHOOT = 0: GOTO ML
LOCATE X - 1, Y: COLOR 4: PRINT "³"
WAND.DIR = 1
WANDS = WANDS - 1
WANDS.SHOOT = 1
WANDX = X - 1: WANDY = Y
GOTO ML

W.Down:
IF WANDS = 0 THEN GOTO ML
IF WANDS.SHOOT = 1 THEN GOTO ML
IF X + 1 > 27 THEN WANDS.SHOOT = 0: GOTO ML
LOCATE X + 1, Y: COLOR 4: PRINT "³"
WAND.DIR = 2
WANDS = WANDS - 1
WANDS.SHOOT = 1
WANDX = X + 1: WANDY = Y
GOTO ML

W.Left:
IF WANDS = 0 THEN GOTO ML
IF WANDS.SHOOT = 1 THEN GOTO ML
IF Y - 1 < 2 THEN WANDS.SHOOT = 0: GOTO ML
LOCATE X, Y - 1: COLOR 4: PRINT "-"
WAND.DIR = 3
WANDS = WANDS - 1
WANDS.SHOOT = 1
WANDX = X: WANDY = Y - 1
GOTO ML

W.Right:
IF WANDS = 0 THEN GOTO ML
IF WANDS.SHOOT = 1 THEN GOTO ML
IF Y + 1 > 78 THEN WANDS.SHOOT = 0: GOTO ML
LOCATE X, Y + 1: COLOR 4: PRINT "-"
WAND.DIR = 4
WANDS = WANDS - 1
WANDS.SHOOT = 1
WANDX = X: WANDY = Y + 1
GOTO ML

'*******************************************
WandUpdate:
SELECT CASE WAND.DIR

CASE 1
IF WANDX - 1 < 4 THEN LOCATE WANDX, WANDY: PRINT " ": WANDS.SHOOT = 0: WAND.DIR = 0: GOTO ML
IF SCREEN(WANDX - 1, WANDY) = 196 THEN SCORE = SCORE + 1
WANDX = WANDX - 1: LOCATE WANDX + 1, WANDY: PRINT " ": COLOR 5: LOCATE WANDX, WANDY: PRINT "³"
LOCATE 2, 2: COLOR 2: PRINT "SCORE:": LOCATE 2, 8: PRINT SCORE
CASE 2
IF WANDX + 1 > 27 THEN LOCATE WANDX, WANDY: PRINT " ": WANDS.SHOOT = 0: WAND.DIR = 0: GOTO ML
IF SCREEN(WANDX + 1, WANDY) = 196 THEN SCORE = SCORE + 1
WANDX = WANDX + 1: LOCATE WANDX - 1, WANDY: PRINT " ": COLOR 5: LOCATE WANDX, WANDY: PRINT "³"
LOCATE 2, 2: COLOR 2: PRINT "SCORE:": LOCATE 2, 8: PRINT SCORE
CASE 3
IF WANDY - 1 < 2 THEN LOCATE WANDX, WANDY: PRINT " ": WANDS.SHOOT = 0: WAND.DIR = 0: GOTO ML
IF SCREEN(WANDX, WANDY - 1) = 196 THEN SCORE = SCORE + 1
WANDY = WANDY - 1: LOCATE WANDX, WANDY + 1: PRINT " ": COLOR 5: LOCATE WANDX, WANDY: PRINT "-"
LOCATE 2, 2: COLOR 2: PRINT "SCORE:": LOCATE 2, 8: PRINT SCORE
CASE 4
IF WANDY + 1 > 79 THEN LOCATE WANDX, WANDY: PRINT " ": WANDS.SHOOT = 0: WAND.DIR = 0: GOTO ML
IF SCREEN(WANDX, WANDY + 1) = 196 THEN SCORE = SCORE + 1
WANDY = WANDY + 1: LOCATE WANDX, WANDY - 1: PRINT " ": COLOR 5: LOCATE WANDX, WANDY: PRINT "-"
LOCATE 2, 2: COLOR 2: PRINT "SCORE:": LOCATE 2, 8: PRINT SCORE

END SELECT
GOTO ML

SUB Cls2 (n)
FOR Z = 0 TO 480 STEP 2: LINE (0, Z)-(640, Z), 0, , &HAAAA: NEXT
FOR Z = 1 TO 481 STEP 2: LINE (1, Z)-(641, Z), 0, , &HAAAA: NEXT
IF n = 1 THEN
FOR Z = 0 TO 480: LINE (0, Z)-(641, Z), 0:   NEXT
END IF
END SUB

SUB DRAWBORDER
FOR Z = 1 TO 80: COLOR 3: LOCATE 1, Z: PRINT "Û": LOCATE 28, Z: PRINT "Û": NEXT
FOR Z = 1 TO 28: COLOR 3: LOCATE Z, 1: PRINT "Û": LOCATE Z, 80: PRINT "Û": NEXT
LOCATE 28, 30: COLOR 1: PRINT "THE JERSY DEVEL 4 BY MATTHEW JOHNSON"
END SUB

SUB DRAWLEVEL

FOR DS = 5 TO 25 STEP 4
COLOR 1
FOR DS2 = 2 TO 78: LOCATE DS, DS2: PRINT "Ä": NEXT
NEXT

FOR DS = 7 TO 23 STEP 4
COLOR 1
FOR DS2 = 3 TO 79: LOCATE DS, DS2: PRINT "Ä": NEXT
NEXT

FOR MS = 1 TO L + 150
A = INT(RND * 27 + 1)
B = INT(RND * 79 + 1)
LOCATE A, B: PRINT " "
NEXT
COLOR 6: LOCATE 4, 2: PRINT CHR$(127)
IF L >= 5 THEN LOCATE LX: COLOR 4: PRINT "="
END SUB

SUB DRAWSCORELINES
FOR Z = 2 TO 79: COLOR 9: LOCATE 3, Z: PRINT "Ä": NEXT
END SUB

SUB INTRO
'*********************INTRO*****************
SCREEN 12
'WIDTH 80, 50
FOR Z = 1 TO 10000: NEXT
COLOR 2

LOCATE 10, 10: PRINT "             "
LOCATE 11, 10: PRINT "       h    o     "
FOR Z = 1 TO 500: NEXT
LOCATE 10, 10: PRINT "    y D   l  "
LOCATE 11, 10: PRINT "     t h    o  s  "
FOR Z = 1 TO 500: NEXT

LOCATE 10, 10: PRINT " er y D   l  "
LOCATE 11, 10: PRINT "   M t h    o ns n"
FOR Z = 1 TO 500: NEXT

LOCATE 10, 10: PRINT " ersy D  il  "
LOCATE 11, 10: PRINT "B  M t hew  o ns n"
FOR Z = 1 TO 500: NEXT

LOCATE 10, 10: PRINT " ersy De il  "
LOCATE 11, 10: PRINT "By M tthew Jo nson"
FOR Z = 1 TO 500: NEXT

LOCATE 10, 10: PRINT "Jersy Devil 4"
LOCATE 11, 10: PRINT "By Matthew Johnson"
FOR Z = 1 TO 10000: NEXT

CLS
COLOR 2
COLOR 3
LOCATE 1, 1: PRINT "New features:"
PRINT
PRINT "/        Magic wand--Cuts trough walls"
PRINT
PRINT "New keys:"
PRINT " R"
PRINT "D G       Controls direction of wand!!!"
PRINT " F"
PRINT
PRINT "PRESS SPACE TO PLAY!!!"
WHILE INKEY$ <> " ": WEND
SCREEN 12
END SUB

SUB KeyBufferEmpty
DO UNTIL INKEY$ = ""
LOOP
END SUB

SUB PUTSCORES
LOCATE 2, 2: COLOR 2: PRINT "SCORE:": LOCATE 2, 8: PRINT SCORE
LOCATE 2, 13: PRINT "STEPS:": LOCATE 2, 19: PRINT STEPS
LOCATE 2, 23: PRINT "LEVEL:": LOCATE 2, 29: PRINT L
LOCATE 2, 32: PRINT "LIVES:": LOCATE 2, 38: PRINT LIVES
END SUB

SUB READINSTR
END SUB

